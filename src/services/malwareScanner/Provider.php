<?php

namespace lenz\craft\essentials\services\malwareScanner;

use craft\elements\Asset;
use lenz\craft\essentials\Plugin;
use lenz\craft\essentials\services\AbstractProvider;
use lenz\craft\essentials\services\malwareScanner\listeners\FileListener;
use yii\base\Event;

/**
 * Class Provider
 */
class Provider extends AbstractProvider
{
  /**
   * @return void
   */
  public static function register(): void {
    $settings = Plugin::getInstance()->getSettings();
    if (empty($settings->malwareCommand)) {
      return;
    }

    Event::on(
      Asset::class,
      Asset::EVENT_BEFORE_HANDLE_FILE,
      FileListener::onBeforeHandleFile(...)
    );
  }
}
